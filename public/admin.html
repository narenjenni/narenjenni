<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Admin â€” SMK Perintis 1 Depok</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={theme:{extend:{fontFamily:{sans:['Inter','ui-sans-serif','system-ui']},colors:{primary:'#1E3A8A'}}}}</script>
</head>
<body class="bg-slate-50 text-slate-800">
<header class="sticky top-0 z-40 backdrop-blur bg-white/80 border-b">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
    <a href="/index.html" class="font-extrabold">SMK Perintis 1 Depok</a>
    <nav class="hidden md:flex gap-6 text-sm">
      <a href="/berita.html" class="hover:text-primary">Berita</a>
      <a href="/agenda.html" class="hover:text-primary">Agenda</a>
      <a href="/galeri.html" class="hover:text-primary">Galeri</a>
      <a href="/ppdb.html" class="hover:text-primary">PPDB</a>
      <a href="/admin.html" class="hover:text-primary">Admin</a>
    </nav>
  </div>
</header>

<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
  <h1 class="text-3xl md:text-4xl font-extrabold">Dashboard Admin PPDB</h1>
  <p class="mt-2 text-slate-600">Masukkan kunci admin (ENV: ADMIN_KEY) untuk melihat daftar pendaftar dan ekspor CSV.</p>
  <div class="mt-6 flex gap-3">
    <input id="key" placeholder="Masukkan ADMIN_KEY" class="rounded-xl border px-3 py-2">
    <button id="load" class="rounded-xl bg-primary px-5 py-2 text-white font-semibold">Muat Data</button>
    <a id="export" class="rounded-xl border px-5 py-2 font-semibold" href="#" target="_blank" rel="noopener">Export CSV</a>
  </div>
  <div id="wrap" class="mt-6 overflow-x-auto hidden">
    <table class="min-w-full border bg-white rounded-2xl overflow-hidden">
      <thead class="bg-slate-100"><tr><th class="px-4 py-3 text-left">Waktu</th><th class="px-4 py-3 text-left">Nama</th><th class="px-4 py-3 text-left">Jurusan</th><th class="px-4 py-3 text-left">Email</th><th class="px-4 py-3 text-left">WA</th></tr></thead>
      <tbody id="rows" class="divide-y"></tbody>
    </table>
  </div>
</section>
<script>
const keyEl=document.getElementById('key');const loadBtn=document.getElementById('load');const rows=document.getElementById('rows');const wrap=document.getElementById('wrap');const exp=document.getElementById('export');
loadBtn.addEventListener('click',async()=>{const key=keyEl.value.trim();if(!key)return alert('Masukkan ADMIN_KEY');const res=await fetch('/api/admin/list',{headers:{'x-admin-key':key}});const data=await res.json();if(!res.ok)return alert(data?.message||'Gagal memuat');wrap.classList.remove('hidden');rows.innerHTML=(data.data||[]).map(it=>`<tr><td class="px-4 py-3">${new Date(it.waktu).toLocaleString('id-ID')}</td><td class="px-4 py-3 font-medium">${it.namaLengkap}</td><td class="px-4 py-3">${it.jurusan}</td><td class="px-4 py-3">${it.email}</td><td class="px-4 py-3">${it.telepon}</td></tr>`).join('');exp.href='/api/admin/export?key='+encodeURIComponent(key);});
</script>

</body>
</html>